(function(e,t){"function"==typeof define&&define.amd?define([],function(){return t()}):"undefined"!=typeof module&&"object"==typeof exports?module.exports=t():void 0!==e&&(e.validall=t())})(this||window,function(){function e(e,t){var r=/\{\{([\w\.]+)\}\}/g;return e.replace(r,function(e,r){var n,a=r.split(".");if(1==a.length)return t[a[0]];n=t[a[0]];for(var u=1;u<a.length;u++)n=n[a[u]];return n})}function t(e,t,r){if(t=t.split("."),1===t.length)return e[t[0]];for(var n=e,a=0;a<t.length;a++){if(!(n=n[t[a]]))return;if(a===t.length-2&&r)return!(!n||!n[t[a+1]])&&(n[t[a+1]]=r,!0);if(a===t.length-1)return n}}function r(e,t,n){if(e instanceof Array&&t instanceof Array){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++){for(var u=!1,i=0;i<t.length;i++)if((n&&r(e[a],t[i])||!n&&e[a]===t[i])&&r(e[a],t[i])){u=!0;break}if(!u)return!1}return!0}if(e instanceof Date&&t instanceof Date)return e.toDateString()===t.toDateString();if(e instanceof RegExp&&t instanceof RegExp)return e.toString()===t.toString();if(e instanceof Object&&t instanceof Object){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var s in e)if(e.hasOwnProperty(s)){var u=!1;for(var o in t)if(t.hasOwnProperty(s)&&(n&&r(e[s],t[o])||!n&&e[s]===t[o])){u=!0;break}if(!u)return!1}return!0}return e===t}function n(t,r,n){var o=[];n=i+n;for(var l in r)if("$message"!==l){if(!f[l])return!1;var y=f[l](t,r[l],n);if(!y){if(r.$message)u.push(r.$message);else if(void 0===r.$message&&"$or"!==l&&"$each"!==l){var c=a[l],h={};h=l.toLowerCase().indexOf("range")>-1?{key:n,min:r[l][0],max:r[l][1]}:Array.isArray(r[l])||r[l]instanceof RegExp?{key:n,value:r[l].toString()}:"object"==typeof r[l]?{key:n,value:JSON.stringify(r[l],null,2)}:{key:n,value:r[l]},"function"==typeof r[l]?u.push(a.none):u.push(e(c,h))}if(!s)return!1}o.push(y)}return o.every(function(e){return e})}var a={$is:"'{{key}}' must be {{value}}",$equals:"'{{key}}' must equals '{{value}}'",$identical:"'{{key}}' must equals '{{value}}'",$gt:"'{{key}}' must be greater than {{value}}",$gte:"'{{key}}' must be greater than or equals to {{value}}",$lt:"'{{key}}' must be less than {{value}}",$lte:"'{{key}}' must be less than or equals to {{value}}",$inRange:"'{{key}}' must be in between {{min}} and {{max}}",$outOfRange:"'{{key}}' must be less than {{min}} or greater than {{max}}",$len:"'{{key}}' length must equals {{value}}",$gtLen:"'{{key}}' length must be greater than {{value}}",$gteLen:"'{{key}}' length must be greater than or equals to {{value}}",$ltLen:"'{{key}}' length must be less than {{value}}",$lteLen:"'{{key}}' length must be less than or equals to {{value}}",$inRangeLen:"'{{key}}' length must be in between {{min}} and {{max}}",$outOfRangeLen:"'{{key}}' length must be less than {{min}} or greater than {{max}}",$size:"'{{key}}' object size must equals {{value}}",$gtSize:"'{{key}}' object size must be greater than {{value}}",$gteSize:"'{{key}}' object size must be greater than or equals to {{value}}",$ltSize:"'{{key}}' object size must be less than {{value}}",$lteSize:"'{{key}}' object size must be less than or equals to {{value}}",$inRangeSize:"'{{key}}' object size must be in between {{min}} and {{max}}",$outOfRangeSize:"'{{key}}' object size must be less than {{min}} or greater than {{max}}",$match:"'{{key}}' must match pattern {{value}}",$has:"'{{key}}' must include [{{value}}]",$hasSome:"'{{key}}' must include at least on of the items: [{{value}}]",$hasNot:"'{{key}}' must not include [{{value}}]",$hasNotSome:"'{{key}}' must not include at least on of the items: [{{value}}]",$hasKeys:"'{{key}}' must include keys: [{{value}}]",$hasSomeKeys:"'{{key}}' must include at least on of the keys: [{{value}}]",$hasNotKeys:"'{{key}}' must not include keys [{{value}}]",$hasNotSomeKeys:"'{{key}}' must not include at least on of the keys: [{{value}}]",$in:"'{{key}}' all items must be included in: [{{value}}]",$someIn:"'{{key}}' must have at least one item included in: [{{value}}]",$notIn:"'{{key}}' must not have any item included in: [{{value}}]",$someNotIn:"'{{key}}' must have at least one item not included in: [{{value}}]",$onDate:"'{{key}}' must be on date: {{value}}",$beforeDate:"'{{key}}' must be before date: {{value}}",$afterDate:"'{{key}}' must be after date: {{value}}",none:"unhandled error!"},u=[],i="",s=!1,o=0,f={$is:function(e,t){var r;switch(t.toLowerCase()){case"number":r=/^\d+$/.test(e);break;case"string":r="string"==typeof e;break;case"boolean":r="boolean"==typeof e;break;case"date":r=e instanceof Date;break;case"regexp":r=e instanceof RegExp;break;case"array":r=Array.isArray(e);break;case"object":r="object"==typeof e&&"[object Object]"===e.toString();break;case"email":r=/^([\w\-]+(?:\.[\w\-]+)*)@((?:[\w\-]+\.)*\w[\w\-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e);break;case"url":r=/(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gim.test(e);break;default:r=!1}return r},$fn:function(e,t){return t(e)},$equals:function(e,t,n){return r(e,t)},$identical:function(e,t,n){return r(e,t,!0)},$gt:function(e,t,r){return e>t},$gte:function(e,t,r){return e>=t},$lt:function(e,t,r){return e<t},$lte:function(e,t,r){return e<=t},$inRange:function(e,t,r){return e>=t[0]&&e<=t[1]},$outOfRange:function(e,t,r){return e<t[0]||e>t[1]},$len:function(e,t,r){return e.length===t},$gtLen:function(e,t,r){return e.length>t},$gteLen:function(e,t,r){return e.length>=t},$ltLen:function(e,t,r){return e.length<t},$lteLen:function(e,t,r){return e.length<=t},$inRangeLen:function(e,t,r){return e.length>=t[0]&&e.length<=t[1]},$outOfRangeLen:function(e,t,r){return e.length<t[0]||e.length>t[1]},$size:function(e,t,r){return Object.keys(e).length===t},$gtSize:function(e,t,r){return Object.keys(e).length>t},$gteSize:function(e,t,r){return Object.keys(e).length>=t},$ltSize:function(e,t,r){return Object.keys(e).length<t},$lteSize:function(e,t,r){return Object.keys(e).length<=t},$inRangeSize:function(e,t,r){return Object.keys(e).length>=t[0]&&Object.keys(e).length<=t[1]},$outOfRangeSize:function(e,t,r){return Object.keys(e).length<t[0]||Object.keys(e).length>t[1]},$match:function(e,t,r){return t.test(e)},$has:function(e,t,r){if(t=Array.isArray(t)?t:[t],Array.isArray(e)){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])===-1)return!1;return!0}return!1},$hasSome:function(e,t,r){if(t=Array.isArray(t)?t:[t],Array.isArray(e)){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return!0;return!1}return!1},$hasNot:function(e,t,r){if(t=Array.isArray(t)?t:[t],Array.isArray(e)){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return!1;return!0}return!1},$hasNotSome:function(e,t,r){if(t=Array.isArray(t)?t:[t],Array.isArray(e)){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])===-1)return!0;return!1}return!1},$hasKeys:function(e,t,r){if(t=Array.isArray(t)?t:[t],!this.$is(e,"object"))return!1;for(var n=0;n<t.length;n++)for(var a=t[n].split("."),u=e,i=0;i<a.length;i++){if(!u.hasOwnProperty(a[i]))return!1;u=u[a[i]]}return!0},$hasSomeKeys:function(e,t,r){if(t=Array.isArray(t)?t:[t],!this.$is(e,"object"))return!1;for(var n=0;n<t.length;n++)for(var a=t[n].split("."),u=e,i=0;i<a.length;i++){if(u.hasOwnProperty(a[i]))return!0;u=u[a[i]]}return!1},$hasNotKeys:function(e,t,r){if(t=Array.isArray(t)?t:[t],!this.$is(e,"object"))return!1;for(var n=0;n<t.length;n++)for(var a=t[n].split("."),u=e,i=0;i<a.length;i++){if(u.hasOwnProperty(a[i]))return!1;u=u[a[i]]}return!0},$hasNotSomeKeys:function(e,t,r){if(t=Array.isArray(t)?t:[t],!this.$is(e,"object"))return!1;for(var n=0;n<t.length;n++)for(var a=t[n].split("."),u=e,i=0;i<a.length;i++){if(!u.hasOwnProperty(a[i]))return!0;u=u[a[i]]}return!1},$in:function(e,t,r){if(e=Array.isArray(e)?e:[e],Array.isArray(t)){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])===-1)return!1;return!0}return!1},$someIn:function(e,t,r){if(e=Array.isArray(e)?e:[e],Array.isArray(t)){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!0;return!1}return!1},$notIn:function(e,t,r){if(e=Array.isArray(e)?e:[e],Array.isArray(t)){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!1;return!0}return!1},$someNotIn:function(e,t,r){if(e=Array.isArray(e)?e:[e],Array.isArray(t)){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])===-1)return!0;return!1}return!1},$onDate:function(e,t){return!isNaN(Date.parse(e))&&!isNaN(Date.parse(t))&&Date.parse(e)===Date.parse(t)},$beforeDate:function(e,t){return!isNaN(Date.parse(e))&&!isNaN(Date.parse(t))&&Date.parse(e)<Date.parse(t)},$afterDate:function(e,t){return!isNaN(Date.parse(e))&&!isNaN(Date.parse(t))&&Date.parse(e)>Date.parse(t)},$or:function(e,t,r){for(var a=0;a<t.length;a++)if(n(e,t[a],r))return!0;return!1},$each:function(e,t,r){if(Array.isArray(e)){var n,a=[];i=r;for(var o=0;o<e.length;o++){if(i=r+"["+o+"].",n=test(e[o],t),!n&&!s)return!1;a.push(n)}return i="",a.every(function(e){return e===!0})}return u.push("'"+r+"' is not an array"),!1}},l={reset:function(){u=[],s=!1,i=""},errors:function(){return u},test:function e(r,a,i){if(o||(this.reset(),i=!!i),o++,!a||"object"!=typeof a)return["Invalid options"];var s=[];for(var f in a){if("$or"===f){for(var l=0;l<a[f].length;l++)if(e.call(this,r,a[f][l]))return!0;return!1}var y;if(y="$root"===f?r:t(r,f),void 0===y)return!1;if("object"==typeof a[f]){var c=a[f];s.push(n(y,c,f))}else{var h=y===a[f];s.push(h),h||u.push("'"+f+"' must equals "+a[f])}}return o--,!!s.every(function(e){return e})}};return l});